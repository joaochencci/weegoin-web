angular.module("ngFacebook",[]).provider("$facebook",function(){var a={permissions:"email",appId:null,customInit:{}};this.setAppId=function(b){a.appId=b;return this};this.getAppId=function(){return a.appId};this.setPermissions=function(b){a.permissions=b;return this};this.getPermissions=function(){return a.permissions};this.setCustomInit=function(b){a.customInit=b;return this};this.getCustomInit=function(){return a.customInit};this.$get=["$q","$rootScope","$window",function(e,c,g){var b=e.defer();b.config=function(h){return a[h]};b.init=function(){if(b.config("appId")==null){throw"$facebookProvider: `appId` cannot be null"}g.FB.init(angular.extend({appId:b.config("appId")},b.config("customInit")));c.$broadcast("fb.load",g.FB)};c.$on("fb.load",function(i,h){b.resolve(h);angular.forEach(["auth.login","auth.logout","auth.prompt","auth.sessionChange","auth.statusChange","auth.authResponseChange","xfbml.render","edge.create","edge.remove","comment.create","comment.remove","message.send"],function(j){h.Event.subscribe(j,function(k){c.$broadcast("fb."+j,k,h)})})});b._cache={};b.setCache=function(h,i){b._cache[h]=i};b.getCache=function(h){if(angular.isUndefined(b._cache[h])){return false}return b._cache[h]};b.clearCache=function(){b._cache={}};var d=e.defer();var f=0;d.id=0;b._reset_login_deferred=function(){b.clearCache();d=e.defer();d.id=f++};b.setCache("connected",null);b.isConnected=function(){return b.getCache("connected")};c.$on("fb.auth.authResponseChange",function(i,h,j){b.clearCache();if(h.status=="connected"){b.setCache("connected",true);d.resolve(j)}else{b.setCache("connected",false);d.reject(h.status)}});c.$on("fb.auth.login",b._reset_login_deferred);c.$on("fb.auth.logout",b._reset_login_deferred);b.getAuthResponse=function(){return FB.getAuthResponse()};b.getLoginStatus=function(i){var h=e.defer();return b.promise.then(function(j){j.getLoginStatus(function(k){if(k.error){h.reject(k.error)}else{h.resolve(k);if(b.isConnected()==null){c.$broadcast("fb.auth.authResponseChange",k,j)}}},i);return h.promise})};b.login=function(){var h=e.defer();return b.promise.then(function(i){i.login(function(j){if(j.error){h.reject(j.error)}else{h.resolve(j)}},{scope:b.config("permissions")});return h.promise})};b.logout=function(){var h=e.defer();return b.promise.then(function(i){i.logout(function(j){if(j.error){h.reject(j.error)}else{h.resolve(j)}});return h.promise})};b.ui=function(i){var h=e.defer();return b.promise.then(function(j){j.ui(i,function(k){if(k.error){h.reject(k.error)}else{h.resolve(k)}});return h.promise})};b.api=function(){var h=e.defer();var i=arguments;i[i.length++]=function(j){if(j.error){h.reject(j.error)}else{h.resolve(j)}};return d.promise.then(function(j){j.api.apply(j,i);return h.promise})};b.cachedApi=function(){if(typeof arguments[0]!=="string"){throw"$facebook.cacheApi can works only with graph requests!"}var i=b.getCache(arguments[0]);if(i){return i}var h=b.api.apply(b,arguments);b.setCache(arguments[0],h);return h};return b}]}).run(["$rootScope","$window","$facebook",function(b,c,a){c.fbAsyncInit=function(){a.init()}}]);